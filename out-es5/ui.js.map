{"version":3,"sources":["../out/ui.js"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","ui","buttonOnClick","arg1","arg2","arg3","element","callback","args","Error","execute","event","button","currentTarget","setAttribute","toast","console","error","removeAttribute","stopPropagation","cancelBubble","confirm","text","message","onclick","dialogContainer","dialogConfig","document","body","addClassName","className","assert","c1","split","c2","itemsToAdd","filter","o","indexOf","push","join","removeClassName","itemsRemain","dialogElements","Array","dialogCallbacks","showDialog","style","display","setTimeout","dialogIndex","length","closeButtons","querySelectorAll","i","hideDialog","allButtons","item","addEventListener","tabIndex","firstField","querySelector","focus","on_keydown","removeEventListener","reslove","removeProperty","KEY_CODE_ESC","keyCode","dialogElement","findDialogElement","target","getAttribute","names","parentElement","alert","createElement","appendChild","title","innerHTML","titleElement","modalFooter","cancelButton","okButton","cancel","cancle","container","confirmText","cancelText","confirmDialogElment","marginTop","modalHeader","modalBody","closeButton","remove","showToastMessage","obj","errors","argumentNull","msg","tagName","options","toastDialogElement","header","showPanel","panel","modal","backdrop","footer","modalDialog","isIOS","navigator","userAgent","dialogRect","getBoundingClientRect","touches","clientX","left","hide","preventDefault","opacity","window","transform","setBodyHeight","headerHeight","height","footerHeight","bodyHeight","innerHeight","paramName","loadImageConfig","imageBaseUrl","imageDisaplyText","config","draws","imageText","ctx","canvasWidth","canvasHeight","fontSize","Math","floor","bgColor","textColor","Object","assign","fillStyle","fillRect","font","textAlign","textWidth","startX","startY","fillText","generateImageBase64","width","canvas","getContext","draw","toDataURL","loadImageByUrl","url","PREVIEW_IMAGE_DEFAULT_WIDTH","PREVIEW_IMAGE_DEFAULT_HEIGHT","renderImage","imageUrl","src","imageSize","match","arr","Number","valueOf","s","src_replace","loadImage","base64","catch","image","Image","onload","imageFileToBase64","imageFile","size","reader","FileReader","readAsArrayBuffer","ev","blob","Blob","blobURL","createObjectURL","drawImage","data","fileToBase64","file","toString","onerror","readAsDataURL","Panel","build","_header","_footer","_body"],"mappings":"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","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar ui;\r\n(function (ui) {\r\n    function buttonOnClick(arg1, arg2, arg3) {\r\n        let element;\r\n        let callback;\r\n        let args;\r\n        if (typeof (arg1) == 'function') {\r\n            callback = arg1;\r\n            args = arg2;\r\n        }\r\n        else if (typeof (arg2) == 'function') {\r\n            element = arg1;\r\n            callback = arg2;\r\n            args = arg3;\r\n        }\r\n        else {\r\n            throw new Error(\"Arguments error\");\r\n        }\r\n        args = args || {};\r\n        let execute = (event) => __awaiter(this, void 0, void 0, function* () {\r\n            let button = event.currentTarget;\r\n            button.setAttribute('disabled', '');\r\n            try {\r\n                yield callback(event);\r\n                if (args.toast) {\r\n                    ui.toast(args.toast);\r\n                }\r\n            }\r\n            catch (exc) {\r\n                console.error(exc);\r\n                throw exc;\r\n            }\r\n            finally {\r\n                button.removeAttribute('disabled');\r\n            }\r\n        });\r\n        let result = function (event) {\r\n            event.stopPropagation();\r\n            event.cancelBubble = true;\r\n            if (!args.confirm) {\r\n                execute(event);\r\n                return;\r\n            }\r\n            let text = typeof args.confirm == 'string' ?\r\n                args.confirm :\r\n                args.confirm();\r\n            ui.confirm({ message: text, confirm: (event) => execute(event) });\r\n        };\r\n        if (element)\r\n            element.onclick = result;\r\n        return result;\r\n    }\r\n    ui.buttonOnClick = buttonOnClick;\r\n})(ui || (ui = {}));\r\nvar ui;\r\n(function (ui) {\r\n    function dialogContainer() {\r\n        return ui.dialogConfig.dialogContainer || document.body;\r\n    }\r\n    ui.dialogConfig = {\r\n        dialogContainer: null\r\n    };\r\n    function addClassName(element, className) {\r\n        console.assert(className != null, 'class is null');\r\n        let c1 = (element.className || '').split(/\\s+/);\r\n        let c2 = className.split(/\\s+/);\r\n        var itemsToAdd = c2.filter(o => c1.indexOf(o) < 0);\r\n        c1.push(...itemsToAdd);\r\n        element.className = c1.join(' ');\r\n    }\r\n    function removeClassName(element, className) {\r\n        console.assert(className != null, 'class is null');\r\n        let c1 = (element.className || '').split(/\\s+/);\r\n        let c2 = className.split(/\\s+/);\r\n        var itemsRemain = c1.filter(o => c2.indexOf(o) < 0);\r\n        element.className = itemsRemain.join(' ');\r\n    }\r\n    let dialogElements = new Array();\r\n    let dialogCallbacks = new Array();\r\n    /** 弹窗\r\n     * @param element bootstrap 的 modal 元素\r\n     */\r\n    function showDialog(element, callback) {\r\n        removeClassName(element, 'out');\r\n        element.style.display = 'block';\r\n        setTimeout(() => {\r\n            addClassName(element, 'modal fade in');\r\n        }, 100);\r\n        let dialogIndex = dialogElements.indexOf(element);\r\n        if (dialogIndex < 0) {\r\n            dialogElements.push(element);\r\n            dialogIndex = dialogElements.length - 1;\r\n            let closeButtons = element.querySelectorAll('[data-dismiss=\"modal\"]') || [];\r\n            for (let i = 0; i < closeButtons.length; i++) {\r\n                closeButtons[i].onclick = () => hideDialog(element);\r\n            }\r\n            let allButtons = element.querySelectorAll('button');\r\n            for (let i = 0; i < allButtons.length; i++) {\r\n                allButtons.item(i).addEventListener('click', function (event) {\r\n                    let callback = dialogCallbacks[dialogIndex];\r\n                    if (callback) {\r\n                        callback(event.currentTarget);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        dialogCallbacks[dialogIndex] = callback;\r\n        element.tabIndex = 1;\r\n        var firstField = element.querySelector('input:not([type]),input:not([readonly])[type=\"text\"],input:not([readonly])[type=\"password\"]');\r\n        if (firstField) {\r\n            firstField.focus();\r\n        }\r\n        else {\r\n            element.focus();\r\n        }\r\n        element.addEventListener('keydown', on_keydown);\r\n    }\r\n    ui.showDialog = showDialog;\r\n    function hideDialog(element) {\r\n        removeClassName(element, 'in');\r\n        addClassName(element, 'modal fade out');\r\n        element.removeEventListener('keydown', on_keydown);\r\n        return new Promise((reslove, reject) => {\r\n            setTimeout(() => {\r\n                element.style.removeProperty('display');\r\n                reslove();\r\n            }, 1000);\r\n        });\r\n    }\r\n    ui.hideDialog = hideDialog;\r\n    function on_keydown(event) {\r\n        const KEY_CODE_ESC = 27;\r\n        if (event.keyCode == KEY_CODE_ESC) {\r\n            let dialogElement = findDialogElement(event.target);\r\n            console.assert(dialogElement != null);\r\n            if (dialogElement.getAttribute('data-keyboard') == 'false')\r\n                return;\r\n            ui.hideDialog(dialogElement);\r\n        }\r\n    }\r\n    function findDialogElement(e) {\r\n        while (e) {\r\n            let names = e.className.split(' ').filter(o => o);\r\n            if (names.indexOf('modal') >= 0)\r\n                return e;\r\n            e = e.parentElement;\r\n        }\r\n    }\r\n    function alert(args) {\r\n        let element = document.createElement('div');\r\n        dialogContainer().appendChild(element);\r\n        if (typeof args == 'string') {\r\n            args = { title: '&nbsp;', message: args };\r\n        }\r\n        element.innerHTML = `\r\n            <div class=\"modal-dialog\">\r\n                \r\n                <div class=\"modal-content\">\r\n                    <div class=\"modal-header\">\r\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\">\r\n                            <span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span>\r\n                        </button>\r\n                        <h4 class=\"modal-title\">${args.title}</h4>\r\n                    </div>\r\n                    <div class=\"modal-body\">\r\n                        <h5>${args.message}</h5>\r\n                    </div>\r\n                    <div class=\"modal-footer\">\r\n                        <button name=\"ok\" type=\"button\" class=\"btn btn-primary\">\r\n                            确定\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n        // $(element).modal();\r\n        // $(element).on('hidden.bs.modal', () => {\r\n        //     $(element).remove();\r\n        // });\r\n        // var dialog = new Dialog(element);\r\n        // dialog.show();\r\n        ui.showDialog(element);\r\n        let titleElement = element.querySelector('.modal-title');\r\n        let modalFooter = element.querySelector('.modal-footer');\r\n        let cancelButton = modalFooter.querySelector('[name=\"cancel\"]');\r\n        let okButton = modalFooter.querySelector('[name=\"ok\"]');\r\n        okButton.onclick = () => ui.hideDialog(element); //dialog.hide()\r\n    }\r\n    ui.alert = alert;\r\n    function confirm(args) {\r\n        let title;\r\n        let message;\r\n        let execute = args.confirm;\r\n        let cancel = args.cancle || (() => Promise.resolve());\r\n        let container = args.container || document.body;\r\n        let confirmText = args.confirmText || '确定';\r\n        let cancelText = args.cancelText || '取消';\r\n        if (typeof args == 'string') {\r\n            message = args;\r\n        }\r\n        else {\r\n            title = args.title;\r\n            message = args.message;\r\n        }\r\n        let confirmDialogElment;\r\n        confirmDialogElment = document.createElement('div');\r\n        confirmDialogElment.className = 'modal fade';\r\n        confirmDialogElment.style.marginTop = '20px';\r\n        console.assert(dialogContainer != null, 'dialog container is null');\r\n        dialogContainer().appendChild(confirmDialogElment);\r\n        confirmDialogElment.innerHTML = `\r\n                    <div class=\"modal-dialog\">\r\n                        <div class=\"modal-content\">\r\n                            <div class=\"modal-header\">\r\n                                <button type=\"button\" class=\"close\" data-dismiss=\"modal\">\r\n                                    <span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span>\r\n                                </button>\r\n                                <h4 class=\"modal-title\">确认</h4>\r\n                            </div>\r\n                            <div class=\"modal-body form-horizontal\">\r\n                               \r\n                            </div>\r\n                            <div class=\"modal-footer\">\r\n                                <button name=\"cancel\" type=\"button\" class=\"btn btn-default\">\r\n                                    ${cancelText}\r\n                                </button>\r\n                                <button name=\"ok\" type=\"button\" class=\"btn btn-primary\">\r\n                                    ${confirmText}\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                `;\r\n        let modalHeader = confirmDialogElment.querySelector('.modal-header');\r\n        let modalBody = confirmDialogElment.querySelector('.modal-body');\r\n        let modalFooter = confirmDialogElment.querySelector('.modal-footer');\r\n        modalBody.innerHTML = `<h5>${message}</h5>`;\r\n        if (title) {\r\n            modalHeader.querySelector('h4').innerHTML = title;\r\n        }\r\n        let cancelButton = modalFooter.querySelector('[name=\"cancel\"]');\r\n        let okButton = modalFooter.querySelector('[name=\"ok\"]');\r\n        let closeButton = modalHeader.querySelector('.close');\r\n        closeButton.onclick = cancelButton.onclick = function () {\r\n            cancel()\r\n                .then(() => ui.hideDialog(confirmDialogElment))\r\n                .then(() => {\r\n                confirmDialogElment.remove();\r\n            });\r\n        };\r\n        okButton.onclick = function (event) {\r\n            execute(event)\r\n                .then(() => ui.hideDialog(confirmDialogElment))\r\n                .then(() => {\r\n                confirmDialogElment.remove();\r\n            });\r\n        };\r\n        ui.showDialog(confirmDialogElment);\r\n    }\r\n    ui.confirm = confirm;\r\n    ui.showToastMessage = toast;\r\n    function toast(obj) {\r\n        if (obj == null)\r\n            throw ui.errors.argumentNull('obj');\r\n        let msg;\r\n        let title;\r\n        if (typeof obj == 'object') {\r\n            if (obj.tagName == null) {\r\n                let options = obj;\r\n                msg = options.message;\r\n                title = options.title;\r\n            }\r\n            else {\r\n                msg = obj;\r\n            }\r\n        }\r\n        else {\r\n            msg = obj;\r\n        }\r\n        let dialogContainer = ui.dialogConfig.dialogContainer || document.body;\r\n        let toastDialogElement = document.createElement('div');\r\n        toastDialogElement.className = 'modal fade in';\r\n        toastDialogElement.style.marginTop = '20px';\r\n        console.assert(dialogContainer != null, 'dialog container is null.');\r\n        dialogContainer.appendChild(toastDialogElement);\r\n        let header = title ? `<div class=\"modal-header\">\r\n                                    <h4 class=\"modal-title\">${title}</h4>\r\n                               </div>` : '';\r\n        toastDialogElement.innerHTML = `\r\n                        <div class=\"modal-dialog\">\r\n                            <div class=\"modal-content\">\r\n                                ${header}\r\n                                <div class=\"modal-body form-horizontal\">\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    `;\r\n        let modalBody = toastDialogElement.querySelector('.modal-body');\r\n        console.assert(modalBody != null);\r\n        if (typeof msg == 'string') {\r\n            modalBody.innerHTML = `<h5>${msg}</h5>`;\r\n        }\r\n        else if (typeof msg == 'function') {\r\n            modalBody.innerHTML = `<h5>${msg()}</h5>`;\r\n        }\r\n        else\r\n            modalBody.appendChild(msg);\r\n        // let dialog = new Dialog(toastDialogElement);\r\n        // dialog.show();\r\n        ui.showDialog(toastDialogElement);\r\n        setTimeout(() => {\r\n            ui.hideDialog(toastDialogElement).then(() => {\r\n                toastDialogElement.remove();\r\n            });\r\n        }, 500);\r\n    }\r\n    ui.toast = toast;\r\n    ui.showPanel = (function () {\r\n        let panel = document.createElement('div');\r\n        panel.className = 'mobile-page panel';\r\n        panel.style.display = 'none';\r\n        document.body.appendChild(panel);\r\n        panel.innerHTML = `\r\n            <div class=\"modal\">\r\n                <div class=\"modal-dialog\">\r\n                    <div class=\"modal-content\">\r\n                        <div class=\"modal-header\">\r\n    \r\n                        </div>\r\n                        <div class=\"modal-body\">\r\n    \r\n                        </div>\r\n                        <div class=\"modal-footer\">\r\n    \r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"modal-backdrop in\">\r\n            </div>\r\n        `;\r\n        let modal = panel.querySelector('.modal');\r\n        let backdrop = panel.querySelector('.modal-backdrop');\r\n        let header = panel.querySelector('.modal-header');\r\n        let footer = panel.querySelector('.modal-footer');\r\n        let body = panel.querySelector(\".modal-body\");\r\n        let modalDialog = panel.querySelector(\".modal-dialog\");\r\n        let isIOS = navigator.userAgent.indexOf('iPhone') > 0 || navigator.userAgent.indexOf('iPad') > 0;\r\n        //=====================================================================\r\n        // 点击非窗口区域，关窗口。并禁用上级元素的 touch 操作。\r\n        // let panel = this.panel; //this.refs['panel'] as HTMLElement;\r\n        // let modalDialog = this.modalDialog; //this.refs['modalDialog'] as HTMLElement;\r\n        panel.addEventListener('touchstart', (event) => {\r\n            let dialogRect = modalDialog.getBoundingClientRect();\r\n            for (let i = 0; i < event.touches.length; i++) {\r\n                let { clientX } = event.touches[i];\r\n                if (clientX < dialogRect.left) {\r\n                    hide();\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n        if (isIOS) {\r\n            panel.addEventListener('touchstart', (event) => {\r\n                let tagName = event.target.tagName;\r\n                if (tagName == 'BUTTON' || tagName == 'INPUT' || tagName == 'A') {\r\n                    return;\r\n                }\r\n                event.stopPropagation();\r\n                event.preventDefault();\r\n            });\r\n        }\r\n        function hide() {\r\n            modal.style.removeProperty('transform');\r\n            backdrop.style.opacity = '0';\r\n            window.setTimeout(() => {\r\n                panel.style.display = 'none';\r\n            }, 500);\r\n        }\r\n        return function showPanel(args) {\r\n            args = args || {};\r\n            panel.style.display = 'block';\r\n            modal.style.display = 'block';\r\n            setTimeout(() => {\r\n                modal.style.transform = 'translateX(0)';\r\n                backdrop.style.opacity = '0.5';\r\n            }, 50);\r\n            let setBodyHeight = () => {\r\n                let headerHeight = header.getBoundingClientRect().height;\r\n                let footerHeight = footer.getBoundingClientRect().height;\r\n                let bodyHeight = window.innerHeight - headerHeight - footerHeight;\r\n                body.style.height = `${bodyHeight}px`;\r\n            };\r\n            window.addEventListener('resize', () => setBodyHeight());\r\n            setBodyHeight();\r\n            if (args.header)\r\n                args.header(header);\r\n            if (args.body)\r\n                args.body(body);\r\n            if (args.footer)\r\n                args.footer(footer);\r\n            return {\r\n                hide: () => hide()\r\n            };\r\n        };\r\n    })();\r\n})(ui || (ui = {}));\r\nvar ui;\r\n(function (ui) {\r\n    ui.errors = {\r\n        argumentNull(paramName) {\r\n            let msg = `Argumnet ${paramName} can not be null or empty.`;\r\n            let error = new Error();\r\n            error.message = msg;\r\n            return error;\r\n        }\r\n    };\r\n})(ui || (ui = {}));\r\nvar ui;\r\n(function (ui) {\r\n    ui.loadImageConfig = {\r\n        /** 图片的基本路径，图片地址如果不以 http 开头，则加上该路径 */\r\n        imageBaseUrl: '',\r\n        /** 图片显示的文字 */\r\n        imageDisaplyText: '',\r\n    };\r\n    let config = ui.loadImageConfig;\r\n    let draws = {\r\n        text: (imageText, options) => {\r\n            return (ctx, canvasWidth, canvasHeight) => {\r\n                // let fontSize1 = Math.floor(canvasHeight / 3 * 0.8);\r\n                let fontSize = Math.floor((canvasWidth / imageText.length) * 0.6);\r\n                let bgColor = 'whitesmoke';\r\n                let textColor = '#999';\r\n                // let fontSize = Math.min(fontSize1, fontSize2);\r\n                options = Object.assign({\r\n                    fontSize,\r\n                    bgColor,\r\n                    textColor\r\n                }, options);\r\n                ctx.fillStyle = options.bgColor; //'whitesmoke';\r\n                ctx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n                // 设置字体\r\n                ctx.font = `Bold ${options.fontSize}px Arial`;\r\n                // 设置对齐方式\r\n                ctx.textAlign = \"left\";\r\n                // 设置填充颜色\r\n                ctx.fillStyle = options.textColor; //\"#999\";\r\n                let textWidth = fontSize * imageText.length;\r\n                let startX = Math.floor((canvasWidth - textWidth) * 0.5);\r\n                let startY = Math.floor((canvasHeight - options.fontSize) * 0.3);\r\n                // 设置字体内容，以及在画布上的位置\r\n                ctx.fillText(imageText, startX, Math.floor(canvasHeight * 0.6));\r\n            };\r\n        }\r\n    };\r\n    function generateImageBase64(width, height, obj, options) {\r\n        var canvas = document.createElement('canvas');\r\n        canvas.width = width; //img_width;\r\n        canvas.height = height; //img_height;\r\n        var ctx = canvas.getContext('2d');\r\n        let draw = typeof obj == 'string' ? draws.text(obj, options) : obj;\r\n        draw(ctx, width, height);\r\n        return canvas.toDataURL();\r\n    }\r\n    ui.generateImageBase64 = generateImageBase64;\r\n    function loadImageByUrl(url) {\r\n    }\r\n    const PREVIEW_IMAGE_DEFAULT_WIDTH = 200;\r\n    const PREVIEW_IMAGE_DEFAULT_HEIGHT = 200;\r\n    /**\r\n     * 在 IMG 元素上渲染图片\r\n     * @param element 要渲染的 IMG 元素\r\n     * @param options 渲染选项，默认将 IMG 元素的 SRC 属性渲染出来\r\n     */\r\n    function renderImage(element, options) {\r\n        options = options || {};\r\n        if (!element)\r\n            throw ui.errors.argumentNull('element');\r\n        let imageUrl = element.src || '';\r\n        if (imageUrl.indexOf('data:image/png;base64') == 0 || element['rendered']) {\r\n            return;\r\n        }\r\n        element.title = imageUrl;\r\n        //====================================================\r\n        // 通过 URL 设置图片大小\r\n        if (imageUrl && !options.imageSize) {\r\n            var match = imageUrl.match(/_\\d+_\\d+/);\r\n            if (match && match.length > 0) {\r\n                var arr = match[0].split('_');\r\n                if (arr.length >= 2) {\r\n                    var width = new Number(arr[1]).valueOf();\r\n                    var height = new Number(arr[2]).valueOf();\r\n                    options.imageSize = { width, height };\r\n                }\r\n            }\r\n        }\r\n        //====================================================\r\n        options.imageSize = options.imageSize || { width: PREVIEW_IMAGE_DEFAULT_WIDTH, height: PREVIEW_IMAGE_DEFAULT_HEIGHT };\r\n        //====================================================\r\n        if (!options.imageText) {\r\n            options.imageText = element.title || '';\r\n            ;\r\n        }\r\n        let s = options.imageSize;\r\n        //设置默认的图片\r\n        var src_replace = generateImageBase64(s.width, s.height, draws.text(options.imageText || config.imageDisaplyText)); //getPreviewImage(imageText || config.imageDisaplyText, img_width, img_height);\r\n        element.setAttribute('src', src_replace);\r\n        return new Promise((resolve, reject) => {\r\n            if (options.loadImage) {\r\n                options.loadImage()\r\n                    .then(base64 => base64 ? Promise.resolve(base64) : Promise.reject({}))\r\n                    .catch(() => {\r\n                    let base64 = generateImageBase64(s.width, s.height, draws.text('加载图片失败', { fontSize: 24 }));\r\n                    return Promise.resolve(base64);\r\n                })\r\n                    .then((base64) => {\r\n                    element.src = base64;\r\n                    element['rendered'] = true;\r\n                });\r\n            }\r\n            else {\r\n                var image = new Image();\r\n                image.onload = function () {\r\n                    element.src = this.src;\r\n                    element['rendered'] = true;\r\n                    resolve(element.src);\r\n                };\r\n                image.src = imageUrl;\r\n            }\r\n        });\r\n    }\r\n    ui.renderImage = renderImage;\r\n    function imageFileToBase64(imageFile, size) {\r\n        if (!imageFile)\r\n            throw ui.errors.argumentNull('imageFile');\r\n        return new Promise((resolve, reject) => {\r\n            var reader = new FileReader();\r\n            reader.readAsArrayBuffer(imageFile);\r\n            reader.onload = (ev) => {\r\n                var blob = new Blob([event.target['result']]);\r\n                window['URL'] = window['URL'] || window['webkitURL'];\r\n                var blobURL = window['URL'].createObjectURL(blob);\r\n                var image = new Image();\r\n                image.src = blobURL;\r\n                image.onload = () => {\r\n                    var canvas = document.createElement('canvas');\r\n                    size = size || {};\r\n                    let width = size.width != null && size.width < image.width ? size.width : image.width;\r\n                    let height = size.height != null && size.height < image.height ? size.height : image.height;\r\n                    if (width != null && height == null) {\r\n                        height = width / image.width * image.height;\r\n                    }\r\n                    else if (width == null && height != null) {\r\n                        width = height / image.height * image.width;\r\n                    }\r\n                    canvas.width = width;\r\n                    canvas.height = height;\r\n                    var ctx = canvas.getContext(\"2d\");\r\n                    ctx.drawImage(image, 0, 0, width, height);\r\n                    let data = canvas.toDataURL(\"image/jpeg\", 0.5);\r\n                    resolve({ base64: data, width, height });\r\n                };\r\n            };\r\n        });\r\n    }\r\n    ui.imageFileToBase64 = imageFileToBase64;\r\n    function fileToBase64(file) {\r\n        return new Promise((resolve, reject) => {\r\n            let reader = new FileReader();\r\n            reader.onload = function () {\r\n                resolve(reader.result.toString());\r\n            };\r\n            reader.onerror = function () {\r\n                reject(reader.error);\r\n            };\r\n            reader.readAsDataURL(file);\r\n        });\r\n    }\r\n    ui.fileToBase64 = fileToBase64;\r\n})(ui || (ui = {}));\r\nvar ui;\r\n(function (ui) {\r\n    class Panel {\r\n        constructor(element) {\r\n            if (!element)\r\n                throw ui.errors.argumentNull('element');\r\n            this.build(element);\r\n            let isIOS = navigator.userAgent.indexOf('iPhone') > 0 || navigator.userAgent.indexOf('iPad') > 0;\r\n            //=====================================================================\r\n            // 点击非窗口区域，关窗口。并禁用上级元素的 touch 操作。\r\n            // let panel = this.panel; //this.refs['panel'] as HTMLElement;\r\n            // let modalDialog = this.modalDialog; //this.refs['modalDialog'] as HTMLElement;\r\n            this.panel.addEventListener('touchstart', (event) => {\r\n                let dialogRect = this.modalDialog.getBoundingClientRect();\r\n                for (let i = 0; i < event.touches.length; i++) {\r\n                    let { clientX } = event.touches[i];\r\n                    if (clientX < dialogRect.left) {\r\n                        this.hide();\r\n                        return;\r\n                    }\r\n                }\r\n            });\r\n            //=========================================================\r\n            // 防止滚动面板时，事件穿透到面板底下的页面\r\n            if (isIOS) {\r\n                this.panel.addEventListener('touchstart', (event) => {\r\n                    let tagName = event.target.tagName;\r\n                    if (tagName == 'BUTTON' || tagName == 'INPUT' || tagName == 'A') {\r\n                        return;\r\n                    }\r\n                    event.stopPropagation();\r\n                    event.preventDefault();\r\n                });\r\n            }\r\n            //=========================================================\r\n        }\r\n        get header() {\r\n            return this._header;\r\n        }\r\n        get body() {\r\n            return this._body;\r\n        }\r\n        get footer() {\r\n            return this._footer;\r\n        }\r\n        build(element) {\r\n            this.panel = element;\r\n            this.panel.className = 'panel';\r\n            this.panel.style.display = 'none';\r\n            // document.body.appendChild(panel);\r\n            this.panel.innerHTML = `\r\n                <div class=\"modal\">\r\n                    <div class=\"modal-dialog\">\r\n                        <div class=\"modal-content\">\r\n                            <div class=\"modal-header\">\r\n        \r\n                            </div>\r\n                            <div class=\"modal-body\">\r\n        \r\n                            </div>\r\n                            <div class=\"modal-footer\">\r\n        \r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"modal-backdrop in\">\r\n                </div>\r\n            `;\r\n            this.modal = this.panel.querySelector('.modal');\r\n            this.backdrop = this.panel.querySelector('.modal-backdrop');\r\n            this._header = this.panel.querySelector('.modal-header');\r\n            this._footer = this.panel.querySelector('.modal-footer');\r\n            this._body = this.panel.querySelector(\".modal-body\");\r\n            this.modalDialog = this.panel.querySelector(\".modal-dialog\");\r\n        }\r\n        show() {\r\n            // args = args || {};\r\n            this.panel.style.display = 'block';\r\n            this.modal.style.display = 'block';\r\n            setTimeout(() => {\r\n                this.modal.style.transform = 'translateX(0)';\r\n                this.backdrop.style.opacity = '0.5';\r\n            }, 50);\r\n            let setBodyHeight = () => {\r\n                let headerHeight = this._header.getBoundingClientRect().height;\r\n                let footerHeight = this._footer.getBoundingClientRect().height;\r\n                let bodyHeight = window.innerHeight - headerHeight - footerHeight;\r\n                this._body.style.height = `${bodyHeight}px`;\r\n            };\r\n            window.addEventListener('resize', () => setBodyHeight());\r\n            setBodyHeight();\r\n            // if (args.header)\r\n            //     args.header(header);\r\n            // if (args.body)\r\n            //     args.body(body);\r\n            // if (args.footer)\r\n            //     args.footer(footer);\r\n            // return {\r\n            //     hide: () => hide()\r\n            // }\r\n        }\r\n        hide() {\r\n            this.modal.style.removeProperty('transform');\r\n            this.backdrop.style.opacity = '0';\r\n            window.setTimeout(() => {\r\n                this.panel.style.display = 'none';\r\n            }, 500);\r\n        }\r\n    }\r\n    ui.Panel = Panel;\r\n})(ui || (ui = {}));\r\n"],"file":"ui.js"}