{"version":3,"sources":["../out/panel.js"],"names":["Object","defineProperty","exports","value","errors_1","require","Panel","element","errors","argumentNull","build","isIOS","navigator","userAgent","indexOf","panel","addEventListener","event","dialogRect","modalDialog","getBoundingClientRect","i","touches","length","clientX","left","hide","tagName","target","stopPropagation","preventDefault","className","style","display","innerHTML","modal","querySelector","backdrop","_header","_footer","_body","setTimeout","transform","opacity","setBodyHeight","headerHeight","height","footerHeight","bodyHeight","window","innerHeight","removeProperty"],"mappings":"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","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst errors_1 = require(\"./errors\");\r\nclass Panel {\r\n    constructor(element) {\r\n        if (!element)\r\n            throw errors_1.errors.argumentNull('element');\r\n        this.build(element);\r\n        let isIOS = navigator.userAgent.indexOf('iPhone') > 0 || navigator.userAgent.indexOf('iPad') > 0;\r\n        //=====================================================================\r\n        // 点击非窗口区域，关窗口。并禁用上级元素的 touch 操作。\r\n        // let panel = this.panel; //this.refs['panel'] as HTMLElement;\r\n        // let modalDialog = this.modalDialog; //this.refs['modalDialog'] as HTMLElement;\r\n        this.panel.addEventListener('touchstart', (event) => {\r\n            let dialogRect = this.modalDialog.getBoundingClientRect();\r\n            for (let i = 0; i < event.touches.length; i++) {\r\n                let { clientX } = event.touches[i];\r\n                if (clientX < dialogRect.left) {\r\n                    this.hide();\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n        //=========================================================\r\n        // 防止滚动面板时，事件穿透到面板底下的页面\r\n        if (isIOS) {\r\n            this.panel.addEventListener('touchstart', (event) => {\r\n                let tagName = event.target.tagName;\r\n                if (tagName == 'BUTTON' || tagName == 'INPUT' || tagName == 'A') {\r\n                    return;\r\n                }\r\n                event.stopPropagation();\r\n                event.preventDefault();\r\n            });\r\n        }\r\n        //=========================================================\r\n    }\r\n    get header() {\r\n        return this._header;\r\n    }\r\n    get body() {\r\n        return this._body;\r\n    }\r\n    get footer() {\r\n        return this._footer;\r\n    }\r\n    build(element) {\r\n        this.panel = element;\r\n        this.panel.className = 'panel';\r\n        this.panel.style.display = 'none';\r\n        // document.body.appendChild(panel);\r\n        this.panel.innerHTML = `\r\n            <div class=\"modal\">\r\n                <div class=\"modal-dialog\">\r\n                    <div class=\"modal-content\">\r\n                        <div class=\"modal-header\">\r\n    \r\n                        </div>\r\n                        <div class=\"modal-body\">\r\n    \r\n                        </div>\r\n                        <div class=\"modal-footer\">\r\n    \r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"modal-backdrop in\">\r\n            </div>\r\n        `;\r\n        this.modal = this.panel.querySelector('.modal');\r\n        this.backdrop = this.panel.querySelector('.modal-backdrop');\r\n        this._header = this.panel.querySelector('.modal-header');\r\n        this._footer = this.panel.querySelector('.modal-footer');\r\n        this._body = this.panel.querySelector(\".modal-body\");\r\n        this.modalDialog = this.panel.querySelector(\".modal-dialog\");\r\n    }\r\n    show() {\r\n        // args = args || {};\r\n        this.panel.style.display = 'block';\r\n        this.modal.style.display = 'block';\r\n        setTimeout(() => {\r\n            this.modal.style.transform = 'translateX(0)';\r\n            this.backdrop.style.opacity = '0.5';\r\n        }, 50);\r\n        let setBodyHeight = () => {\r\n            let headerHeight = this._header.getBoundingClientRect().height;\r\n            let footerHeight = this._footer.getBoundingClientRect().height;\r\n            let bodyHeight = window.innerHeight - headerHeight - footerHeight;\r\n            this._body.style.height = `${bodyHeight}px`;\r\n        };\r\n        window.addEventListener('resize', () => setBodyHeight());\r\n        setBodyHeight();\r\n        // if (args.header)\r\n        //     args.header(header);\r\n        // if (args.body)\r\n        //     args.body(body);\r\n        // if (args.footer)\r\n        //     args.footer(footer);\r\n        // return {\r\n        //     hide: () => hide()\r\n        // }\r\n    }\r\n    hide() {\r\n        this.modal.style.removeProperty('transform');\r\n        this.backdrop.style.opacity = '0';\r\n        window.setTimeout(() => {\r\n            this.panel.style.display = 'none';\r\n        }, 500);\r\n    }\r\n}\r\nexports.Panel = Panel;\r\n"],"file":"panel.js"}