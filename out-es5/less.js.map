{"version":3,"sources":["../out/less.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","less","require","errors_1","Less","url","el","document","createElement","href","pathname","options","wrapperClassName","name","baseUrl","location","protocol","host","console","assert","fetch","res","text","renderByText","moduleName","contextName","req","requirejs","context","str","lessText","errors","argumentNull","argumentTypeIncorrect","extractUrlParts","FileManager","prototype","render","error","styleElement","head","querySelector","appendChild","setAttribute","innerText","css"],"mappings":"AAAA;;;;;;;;AACA,IAAIA,SAAS,GAAI,UAAQ,SAAKA,SAAd,IAA4B,UAAUC,OAAV,EAAmBC,UAAnB,EAA+BC,CAA/B,EAAkCC,SAAlC,EAA6C;AACrF,WAASC,KAAT,CAAeC,KAAf,EAAsB;AAAE,WAAOA,KAAK,YAAYH,CAAjB,GAAqBG,KAArB,GAA6B,IAAIH,CAAJ,CAAM,UAAUI,OAAV,EAAmB;AAAEA,MAAAA,OAAO,CAACD,KAAD,CAAP;AAAiB,KAA5C,CAApC;AAAoF;;AAC5G,SAAO,KAAKH,CAAC,KAAKA,CAAC,GAAGK,OAAT,CAAN,EAAyB,UAAUD,OAAV,EAAmBE,MAAnB,EAA2B;AACvD,aAASC,SAAT,CAAmBJ,KAAnB,EAA0B;AAAE,UAAI;AAAEK,QAAAA,IAAI,CAACP,SAAS,CAACQ,IAAV,CAAeN,KAAf,CAAD,CAAJ;AAA8B,OAApC,CAAqC,OAAOO,CAAP,EAAU;AAAEJ,QAAAA,MAAM,CAACI,CAAD,CAAN;AAAY;AAAE;;AAC3F,aAASC,QAAT,CAAkBR,KAAlB,EAAyB;AAAE,UAAI;AAAEK,QAAAA,IAAI,CAACP,SAAS,CAAC,OAAD,CAAT,CAAmBE,KAAnB,CAAD,CAAJ;AAAkC,OAAxC,CAAyC,OAAOO,CAAP,EAAU;AAAEJ,QAAAA,MAAM,CAACI,CAAD,CAAN;AAAY;AAAE;;AAC9F,aAASF,IAAT,CAAcI,MAAd,EAAsB;AAAEA,MAAAA,MAAM,CAACC,IAAP,GAAcT,OAAO,CAACQ,MAAM,CAACT,KAAR,CAArB,GAAsCD,KAAK,CAACU,MAAM,CAACT,KAAR,CAAL,CAAoBW,IAApB,CAAyBP,SAAzB,EAAoCI,QAApC,CAAtC;AAAsF;;AAC9GH,IAAAA,IAAI,CAAC,CAACP,SAAS,GAAGA,SAAS,CAACc,KAAV,CAAgBjB,OAAhB,EAAyBC,UAAU,IAAI,EAAvC,CAAb,EAAyDU,IAAzD,EAAD,CAAJ;AACH,GALM,CAAP;AAMH,CARD;;AASAO,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEf,EAAAA,KAAK,EAAE;AAAT,CAA7C;;AACA,IAAMgB,IAAI,GAAGC,OAAO,CAAC,QAAD,CAApB;;AACA,IAAMC,QAAQ,GAAGD,OAAO,CAAC,UAAD,CAAxB;;IACME,I;;;;;;;;;6BACcC,G,EAAK;AACjB,UAAIC,EAAE,GAAGC,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAT;AACAF,MAAAA,EAAE,CAACG,IAAH,GAAUJ,GAAV;AACA,aAAOC,EAAE,CAACI,QAAV;AACH;;;yBACWL,G,EAAKM,O,EAAS;AACtB,aAAOhC,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB;AAAA;AAAA,8BAAuB;AAAA;;AAAA;AAAA;AAAA;AAAA;AACnCgC,gBAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB;AADmC,2BAEFA,OAFE,EAE7BC,gBAF6B,YAE7BA,gBAF6B,EAEXC,IAFW,YAEXA,IAFW;;AAGnC,oBAAI,CAACF,OAAO,CAACG,OAAb,EAAsB;AAAA,8BACOC,QADP,EACZC,QADY,aACZA,QADY,EACFC,IADE,aACFA,IADE;AAEdP,kBAAAA,QAFc,GAEHN,IAAI,CAACM,QAAL,CAAcL,GAAd,CAFG;AAGlBa,kBAAAA,OAAO,CAACC,MAAR,CAAeT,QAAQ,CAAC,CAAD,CAAR,IAAe,GAA9B;AACAC,kBAAAA,OAAO,CAACG,OAAR,aAAqBE,QAArB,eAAkCC,IAAlC,SAAyCP,QAAzC;AACH;;AARkC;AASzB,uBAAMU,KAAK,CAACf,GAAD,CAAX;;AATyB;AAS/BgB,gBAAAA,GAT+B;AAAA;AAUxB,uBAAMA,GAAG,CAACC,IAAJ,EAAN;;AAVwB;AAU/BA,gBAAAA,IAV+B;;AAWnC,oBAAIV,gBAAJ,EAAsB;AAClBU,kBAAAA,IAAI,cAAOV,gBAAP,eAA4BU,IAA5B,MAAJ;AACH;;AACDlB,gBAAAA,IAAI,CAACmB,YAAL,CAAkBD,IAAlB,EAAwBX,OAAxB;;AAdmC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAvB,EAAhB;AAgBH;;;sCACwBa,U,EAAYb,O,EAAS;AAC1C,aAAOhC,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB;AAAA;AAAA,8BAAuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAEnC,oBAAIgC,OAAO,CAACc,WAAZ,EAAyB;AACrBC,kBAAAA,GAAG,GAAGC,SAAS,CAAC;AAAEC,oBAAAA,OAAO,EAAEjB,OAAO,CAACc;AAAnB,mBAAD,CAAf;AACH,iBAFD,MAGK;AACDC,kBAAAA,GAAG,GAAGC,SAAN;AACH;;AACDD,gBAAAA,GAAG,CAAC,gBAASF,UAAT,EAAD,EAAyB,UAAUK,GAAV,EAAe;AACvCX,kBAAAA,OAAO,CAACC,MAAR,CAAeU,GAAf;AACAzB,kBAAAA,IAAI,CAACmB,YAAL,CAAkBM,GAAlB,EAAuBlB,OAAvB;AACH,iBAHE,CAAH;;AARmC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAvB,EAAhB;AAaH;;;iCACmBmB,Q,EAAUnB,O,EAAS;AACnC,aAAOhC,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB;AAAA;AAAA,8BAAuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAC9BmD,QAD8B;AAAA;AAAA;AAAA;;AAAA,sBAEzB3B,QAAQ,CAAC4B,MAAT,CAAgBC,YAAhB,CAA6B,UAA7B,CAFyB;;AAAA;AAAA,sBAG/B,OAAOF,QAAP,IAAmB,QAHY;AAAA;AAAA;AAAA;;AAAA,sBAIzB3B,QAAQ,CAAC4B,MAAT,CAAgBE,qBAAhB,CAAsC,UAAtC,EAAkD,QAAlD,CAJyB;;AAAA;AAKnCtB,gBAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB;;AACA,oBAAIA,OAAO,CAACG,OAAZ,EAAqB;AACboB,kBAAAA,eADa,GACKjC,IAAI,CAACkC,WAAL,CAAiBC,SAAjB,CAA2BF,eADhC;;AAEjBjC,kBAAAA,IAAI,CAACkC,WAAL,CAAiBC,SAAjB,CAA2BF,eAA3B,GAA6C,UAAU7B,GAAV,EAAe;AACxD,2BAAO6B,eAAe,CAACrC,KAAhB,CAAsBI,IAAtB,EAA4B,CAACI,GAAD,EAAMM,OAAO,CAACG,OAAd,CAA5B,CAAP;AACH,mBAFD;AAGH;;AACDb,gBAAAA,IAAI,CAACoC,MAAL,CAAYP,QAAZ,EAAsB,UAAUtC,CAAV,EAAaE,MAAb,EAAqB;AACvC,sBAAIF,CAAJ,EAAO;AACH0B,oBAAAA,OAAO,CAACoB,KAAR,CAAc9C,CAAd;AACA;AACH;;AACD,sBAAI+C,YAAY,GAAG,IAAnB;;AACA,sBAAI1B,IAAJ,EAAU;AACNK,oBAAAA,OAAO,CAACC,MAAR,CAAeZ,QAAQ,CAACiC,IAAT,IAAiB,IAAhC;AACA,wBAAIA,IAAI,GAAGjC,QAAQ,CAACiC,IAApB;AACAD,oBAAAA,YAAY,GAAGC,IAAI,CAACC,aAAL,6BAAuC5B,IAAvC,SAAf;AACH;;AACD,sBAAI0B,YAAY,IAAI,IAApB,EAA0B;AACtBA,oBAAAA,YAAY,GAAGhC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAf;AACAD,oBAAAA,QAAQ,CAACiC,IAAT,CAAcE,WAAd,CAA0BH,YAA1B;AACA,wBAAI1B,IAAJ,EACI0B,YAAY,CAACI,YAAb,CAA0B,WAA1B,EAAuC9B,IAAvC;AACP;;AACD0B,kBAAAA,YAAY,CAACK,SAAb,GAAyBlD,MAAM,CAACmD,GAAhC;AACH,iBAlBD;;AAZmC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAvB,EAAhB;AAgCH;;;0BACYf,Q,EAAU;AACnB,aAAO,IAAI3C,OAAJ,CAAY,UAACD,OAAD,EAAUE,MAAV,EAAqB;AACpCa,QAAAA,IAAI,CAACoC,MAAL,CAAYP,QAAZ,EAAsB,UAAUtC,CAAV,EAAaE,MAAb,EAAqB;AACvC,cAAIF,CAAJ,EAAO;AACHJ,YAAAA,MAAM,CAACI,CAAD,CAAN;AACA;AACH;;AACDN,UAAAA,OAAO,CAACQ,MAAM,CAACmD,GAAR,CAAP;AACH,SAND;AAOH,OARM,CAAP;AASH;;;;;;AAEL7C,OAAO,CAACI,IAAR,GAAeA,IAAf","sourcesContent":["\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst less = require(\"lessjs\");\r\nconst errors_1 = require(\"./errors\");\r\nclass Less {\r\n    static pathname(url) {\r\n        let el = document.createElement('a');\r\n        el.href = url;\r\n        return el.pathname;\r\n    }\r\n    static load(url, options) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            options = options || {};\r\n            let { wrapperClassName, name } = options;\r\n            if (!options.baseUrl) {\r\n                let { protocol, host } = location;\r\n                let pathname = Less.pathname(url);\r\n                console.assert(pathname[0] == \"/\");\r\n                options.baseUrl = `${protocol}//${host}${pathname}`;\r\n            }\r\n            let res = yield fetch(url);\r\n            let text = yield res.text();\r\n            if (wrapperClassName) {\r\n                text = `.${wrapperClassName} {${text}}`;\r\n            }\r\n            Less.renderByText(text, options);\r\n        });\r\n    }\r\n    static renderByRequireJS(moduleName, options) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let req;\r\n            if (options.contextName) {\r\n                req = requirejs({ context: options.contextName });\r\n            }\r\n            else {\r\n                req = requirejs;\r\n            }\r\n            req([`text!${moduleName}`], function (str) {\r\n                console.assert(str);\r\n                Less.renderByText(str, options);\r\n            });\r\n        });\r\n    }\r\n    static renderByText(lessText, options) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!lessText)\r\n                throw errors_1.errors.argumentNull(\"lessText\");\r\n            if (typeof lessText != \"string\")\r\n                throw errors_1.errors.argumentTypeIncorrect(\"lessText\", \"string\");\r\n            options = options || {};\r\n            if (options.baseUrl) {\r\n                let extractUrlParts = less.FileManager.prototype.extractUrlParts;\r\n                less.FileManager.prototype.extractUrlParts = function (url) {\r\n                    return extractUrlParts.apply(less, [url, options.baseUrl]);\r\n                };\r\n            }\r\n            less.render(lessText, function (e, result) {\r\n                if (e) {\r\n                    console.error(e);\r\n                    return;\r\n                }\r\n                let styleElement = null;\r\n                if (name) {\r\n                    console.assert(document.head != null);\r\n                    let head = document.head;\r\n                    styleElement = head.querySelector(`style[data-name=\"${name}\"]`);\r\n                }\r\n                if (styleElement == null) {\r\n                    styleElement = document.createElement('style');\r\n                    document.head.appendChild(styleElement);\r\n                    if (name)\r\n                        styleElement.setAttribute(\"data-name\", name);\r\n                }\r\n                styleElement.innerText = result.css;\r\n            });\r\n        });\r\n    }\r\n    static parse(lessText) {\r\n        return new Promise((resolve, reject) => {\r\n            less.render(lessText, function (e, result) {\r\n                if (e) {\r\n                    reject(e);\r\n                    return;\r\n                }\r\n                resolve(result.css);\r\n            });\r\n        });\r\n    }\r\n}\r\nexports.Less = Less;\r\n"],"file":"less.js"}