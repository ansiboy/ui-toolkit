{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./out/dialog.js","webpack:///./out/errors.js","webpack:///./out/index.js","webpack:///./out/buttonOnClick.js","webpack:///./out/image.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","errors_1","dialogContainer","dialogConfig","document","body","addClassName","element","className","console","assert","c1","split","itemsToAdd","filter","indexOf","push","join","removeClassName","c2","itemsRemain","dialogElements","Array","dialogCallbacks","showDialog","callback","style","display","setTimeout","dialogIndex","length","closeButtons","querySelectorAll","onclick","hideDialog","allButtons","item","addEventListener","event","currentTarget","tabIndex","firstField","querySelector","focus","on_keydown","removeEventListener","Promise","reslove","reject","removeProperty","keyCode","dialogElement","e","names","parentElement","findDialogElement","target","getAttribute","toast","obj","errors","argumentNull","msg","title","tagName","options","message","toastDialogElement","createElement","marginTop","appendChild","header","innerHTML","modalBody","then","remove","alert","args","modalFooter","confirm","confirmDialogElment","execute","cancel","cancle","resolve","confirmText","container","cancelText","modalHeader","cancelButton","okButton","catch","showToastMessage","showPanel","panel","modal","backdrop","footer","modalDialog","isIOS","navigator","userAgent","hide","opacity","window","dialogRect","getBoundingClientRect","touches","clientX","left","stopPropagation","preventDefault","transform","setBodyHeight","headerHeight","height","footerHeight","bodyHeight","innerHeight","[object Object]","paramName","error","Error","buttonOnClick_1","buttonOnClick","dialog_1","image_1","generateImageBase64","renderImage","loadImageConfig","imageFileToBase64","fileToBase64","__awaiter","this","thisArg","_arguments","P","generator","fulfilled","step","next","rejected","result","done","apply","arg1","arg2","arg3","button","setAttribute","exc","removeAttribute","cancelBubble","text","imageDisaplyText","config","draws","imageText","ctx","canvasWidth","canvasHeight","fontSize","Math","floor","assign","bgColor","textColor","fillStyle","fillRect","font","textAlign","textWidth","startX","fillText","width","canvas","getContext","toDataURL","PREVIEW_IMAGE_DEFAULT_WIDTH","PREVIEW_IMAGE_DEFAULT_HEIGHT","imageUrl","src","imageSize","match","arr","Number","valueOf","src_replace","loadImage","base64","image","Image","onload","imageFile","size","reader","FileReader","readAsArrayBuffer","ev","blob","Blob","blobURL","createObjectURL","drawImage","data","file","toString","onerror","readAsDataURL"],"mappings":";;;;;;;;gBACA,IAAAA,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,GAAA,CACAG,EAAAH,EACAI,GAAA,EACAH,QAAA,IAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,IAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,eAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,cAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,KAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,GAIAlC,IAAAmC,EAAA,kCCjFArB,OAAAC,eAAAb,EAAA,cAA8CmB,OAAA,IAC9C,MAAAe,EAAiBpC,EAAQ,GACzB,SAAAqC,IACA,OAAAnC,EAAAoC,aAAAD,iBAAAE,SAAAC,KAKA,SAAAC,EAAAC,EAAAC,GACAC,QAAAC,OAAA,MAAAF,EAAA,iBACA,IAAAG,GAAAJ,EAAAC,WAAA,IAAAI,MAAA,OAEA,IAAAC,EADAL,EAAAI,MAAA,OACAE,OAAApC,GAAAiC,EAAAI,QAAArC,GAAA,GACAiC,EAAAK,QAAAH,GACAN,EAAAC,UAAAG,EAAAM,KAAA,KAEA,SAAAC,EAAAX,EAAAC,GACAC,QAAAC,OAAA,MAAAF,EAAA,iBACA,IAAAG,GAAAJ,EAAAC,WAAA,IAAAI,MAAA,OACAO,EAAAX,EAAAI,MAAA,OACA,IAAAQ,EAAAT,EAAAG,OAAApC,GAAAyC,EAAAJ,QAAArC,GAAA,GACA6B,EAAAC,UAAAY,EAAAH,KAAA,KAhBAlD,EAAAoC,aAAA,CACAD,gBAAA,MAiBA,IAAAmB,EAAA,IAAAC,MACAC,EAAA,IAAAD,MAIA,SAAAE,EAAAjB,EAAAkB,GACAP,EAAAX,EAAA,OACAA,EAAAmB,MAAAC,QAAA,QACAC,WAAA,KACAtB,EAAAC,EAAA,kBACK,KACL,IAAAsB,EAAAR,EAAAN,QAAAR,GACA,GAAAsB,EAAA,GACAR,EAAAL,KAAAT,GACAsB,EAAAR,EAAAS,OAAA,EACA,IAAAC,EAAAxB,EAAAyB,iBAAA,8BACA,QAAA/D,EAAA,EAAuBA,EAAA8D,EAAAD,OAAyB7D,IAChD8D,EAAA9D,GAAAgE,QAAA,KAAAC,EAAA3B,IAEA,IAAA4B,EAAA5B,EAAAyB,iBAAA,UACA,QAAA/D,EAAA,EAAuBA,EAAAkE,EAAAL,OAAuB7D,IAC9CkE,EAAAC,KAAAnE,GAAAoE,iBAAA,iBAAAC,GACA,IAAAb,EAAAF,EAAAM,GACAJ,GACAA,EAAAa,EAAAC,iBAKAhB,EAAAM,GAAAJ,EACAlB,EAAAiC,SAAA,EACA,IAAAC,EAAAlC,EAAAmC,cAAA,+FACAD,EACAA,EAAAE,QAGApC,EAAAoC,QAEApC,EAAA8B,iBAAA,UAAAO,GAGA,SAAAV,EAAA3B,GAIA,OAHAW,EAAAX,EAAA,MACAD,EAAAC,EAAA,kBACAA,EAAAsC,oBAAA,UAAAD,GACA,IAAAE,QAAA,CAAAC,EAAAC,KACApB,WAAA,KACArB,EAAAmB,MAAAuB,eAAA,WACAF,KACS,OAIT,SAAAH,EAAAN,GAEA,GADA,IACAA,EAAAY,QAAA,CACA,IAAAC,EAOA,SAAAC,GACA,KAAAA,GAAA,CACA,IAAAC,EAAAD,EAAA5C,UAAAI,MAAA,KAAAE,OAAApC,MACA,GAAA2E,EAAAtC,QAAA,YACA,OAAAqC,EACAA,IAAAE,eAZAC,CAAAjB,EAAAkB,QAEA,GADA/C,QAAAC,OAAA,MAAAyC,GACA,SAAAA,EAAAM,aAAA,iBACA,OACAvB,EAAAiB,IA6HA,SAAAO,EAAAC,GACA,SAAAA,EACA,MAAA1D,EAAA2D,OAAAC,aAAA,OACA,IAAAC,EACAC,EACA,oBAAAJ,EACA,SAAAA,EAAAK,QAAA,CACA,IAAAC,EAAAN,EACAG,EAAAG,EAAAC,QACAH,EAAAE,EAAAF,WAGAD,EAAAH,OAIAG,EAAAH,EAEA,IAAAzD,EAAAnC,EAAAoC,aAAAD,iBAAAE,SAAAC,KACA8D,EAAA/D,SAAAgE,cAAA,OACAD,EAAA3D,UAAA,gBACA2D,EAAAzC,MAAA2C,UAAA,OACA5D,QAAAC,OAAA,MAAAR,EAAA,6BACAA,EAAAoE,YAAAH,GACA,IAAAI,EAAAR,6FAC8DA,gDAC9D,GACAI,EAAAK,4JAGkCD,gNAMlC,IAAAE,EAAAN,EAAAzB,cAAA,eACAjC,QAAAC,OAAA,MAAA+D,GACA,iBAAAX,EACAW,EAAAD,iBAAqCV,SAErC,mBAAAA,EACAW,EAAAD,iBAAqCV,WAGrCW,EAAAH,YAAAR,GAGAtC,EAAA2C,GACAvC,WAAA,KACAM,EAAAiC,GAAAO,KAAA,KACAP,EAAAQ,YAEK,KAtML5G,EAAAyD,aAYAzD,EAAAmE,aA2DAnE,EAAA6G,MAxCA,SAAAC,GACA,IAAAtE,EAAAH,SAAAgE,cAAA,OACAlE,IAAAoE,YAAA/D,GACA,iBAAAsE,IACAA,EAAA,CAAgBd,MAAA,SAAeG,QAAAW,IAE/BtE,EAAAiE,mbAQkDK,EAAAd,qHAGpBc,EAAAX,kUAgB9B1C,EAAAjB,GACAA,EAAAmC,cAAA,oBACAoC,EAAAvE,EAAAmC,cAAA,iBACAoC,EAAApC,cAAA,mBACAoC,EAAApC,cAAA,eACAT,QAAA,KAAAC,EAAA3B,KA0EAxC,EAAAgH,QAvEA,SAAAF,GACA,IAAAd,EACAG,EAaAc,EAZAC,EAAAJ,EAAAE,QACAG,EAAAL,EAAAM,QAAA,KAAArC,QAAAsC,WAEAC,GADAR,EAAAS,WAAAlF,SAAAC,KACAwE,EAAAQ,aAAA,MACAE,EAAAV,EAAAU,YAAA,KACA,iBAAAV,EACAX,EAAAW,GAGAd,EAAAc,EAAAd,MACAG,EAAAW,EAAAX,UAGAc,EAAA5E,SAAAgE,cAAA,QACA5D,UAAA,aACAwE,EAAAtD,MAAA2C,UAAA,OACA5D,QAAAC,OAAA,MAAAR,EAAA,4BACAA,IAAAoE,YAAAU,GACAA,EAAAR,20BAcsCe,+KAGAF,iKAMtC,IAAAG,EAAAR,EAAAtC,cAAA,iBACA+B,EAAAO,EAAAtC,cAAA,eACAoC,EAAAE,EAAAtC,cAAA,iBACA+B,EAAAD,iBAAiCN,SACjCH,IACAyB,EAAA9C,cAAA,MAAA8B,UAAAT,GAEA,IAAA0B,EAAAX,EAAApC,cAAA,mBACAgD,EAAAZ,EAAApC,cAAA,eACA8C,EAAA9C,cAAA,UACAT,QAAAwD,EAAAxD,QAAA,WACAiD,IACAR,KAAA,IAAAxC,EAAA8C,IACAN,KAAA,KACAM,EAAAL,YAGAe,EAAAzD,QAAA,SAAAK,GACA2C,EAAA3C,GACAoC,KAAA,IAAAxC,EAAA8C,IACAN,KAAA,KACAM,EAAAL,WAEAgB,MAAA,IAAAzD,EAAA8C,KAEAxD,EAAAwD,IAGAjH,EAAA6H,iBAAAlC,EAwDA3F,EAAA2F,QACA3F,EAAA8H,UAAA,WACA,IAAAC,EAAA1F,SAAAgE,cAAA,OACA0B,EAAAtF,UAAA,oBACAsF,EAAApE,MAAAC,QAAA,OACAvB,SAAAC,KAAAiE,YAAAwB,GACAA,EAAAtB,UAAA,giBAmBA,IAAAuB,EAAAD,EAAApD,cAAA,UACAsD,EAAAF,EAAApD,cAAA,mBACA6B,EAAAuB,EAAApD,cAAA,iBACAuD,EAAAH,EAAApD,cAAA,iBACArC,EAAAyF,EAAApD,cAAA,eACAwD,EAAAJ,EAAApD,cAAA,iBACAyD,EAAAC,UAAAC,UAAAtF,QAAA,aAAAqF,UAAAC,UAAAtF,QAAA,UAyBA,SAAAuF,IACAP,EAAArE,MAAAuB,eAAA,aACA+C,EAAAtE,MAAA6E,QAAA,IACAC,OAAA5E,WAAA,KACAkE,EAAApE,MAAAC,QAAA,QACS,KAET,OA3BAmE,EAAAzD,iBAAA,aAAAC,IACA,IAAAmE,EAAAP,EAAAQ,wBACA,QAAAzI,EAAA,EAAuBA,EAAAqE,EAAAqE,QAAA7E,OAA0B7D,IAAA,CACjD,IAAA2I,QAAiBA,GAAUtE,EAAAqE,QAAA1I,GAC3B,GAAA2I,EAAAH,EAAAI,KAEA,YADAP,OAKAH,GACAL,EAAAzD,iBAAA,aAAAC,IACA,IAAA0B,EAAA1B,EAAAkB,OAAAQ,QACA,UAAAA,GAAA,SAAAA,GAAA,KAAAA,IAGA1B,EAAAwE,kBACAxE,EAAAyE,oBAUA,SAAAlC,GACAA,KAAA,GACAiB,EAAApE,MAAAC,QAAA,QACAoE,EAAArE,MAAAC,QAAA,QACAC,WAAA,KACAmE,EAAArE,MAAAsF,UAAA,gBACAhB,EAAAtE,MAAA6E,QAAA,OACS,IACT,IAAAU,EAAA,KACA,IAAAC,EAAA3C,EAAAmC,wBAAAS,OACAC,EAAAnB,EAAAS,wBAAAS,OACAE,EAAAb,OAAAc,YAAAJ,EAAAE,EACA/G,EAAAqB,MAAAyF,UAAmCE,OAUnC,OARAb,OAAAnE,iBAAA,aAAA4E,KACAA,IACApC,EAAAN,QACAM,EAAAN,UACAM,EAAAxE,MACAwE,EAAAxE,QACAwE,EAAAoB,QACApB,EAAAoB,UACA,CACAK,KAAA,IAAAA,MArFA,iCCxQA3H,OAAAC,eAAAb,EAAA,cAA8CmB,OAAA,IAC9CnB,EAAA6F,OAAA,CACA2D,aAAAC,GACA,IAAA1D,cAA8B0D,8BAC9BC,EAAA,IAAAC,MAEA,OADAD,EAAAvD,QAAAJ,EACA2D,kCCNA9I,OAAAC,eAAAb,EAAA,cAA8CmB,OAAA,IAC9C,IAAAyI,EAAsB9J,EAAQ,GAC9BE,EAAA6J,cAAAD,EAAAC,cACA,IAAAC,EAAehK,EAAQ,GACvBE,EAAAyD,WAAAqG,EAAArG,WACAzD,EAAAmE,WAAA2F,EAAA3F,WACAnE,EAAA2F,MAAAmE,EAAAnE,MACA3F,EAAA6G,MAAAiD,EAAAjD,MACA7G,EAAAgH,QAAA8C,EAAA9C,QACAhH,EAAAoC,aAAA0H,EAAA1H,aACA,IAAA2H,EAAcjK,EAAQ,GACtBE,EAAAgK,oBAAAD,EAAAC,oBACAhK,EAAAiK,YAAAF,EAAAE,YACAjK,EAAAkK,gBAAAH,EAAAG,gBACAlK,EAAAmK,kBAAAJ,EAAAI,kBACAnK,EAAAoK,aAAAL,EAAAK,2CCfA,IAAAC,EAAAC,WAAAD,WAAA,SAAAE,EAAAC,EAAAC,EAAAC,GAEA,WAAAD,MAAA1F,UAAA,SAAAsC,EAAApC,GACA,SAAA0F,EAAAxJ,GAAmC,IAAMyJ,EAAAF,EAAAG,KAAA1J,IAA+B,MAAAkE,GAAYJ,EAAAI,IACpF,SAAAyF,EAAA3J,GAAkC,IAAMyJ,EAAAF,EAAA,MAAAvJ,IAAmC,MAAAkE,GAAYJ,EAAAI,IACvF,SAAAuF,EAAAG,GAJA,IAAA5J,EAI+B4J,EAAAC,KAAA3D,EAAA0D,EAAA5J,QAJ/BA,EAI+B4J,EAAA5J,MAJJA,aAAAsJ,EAAAtJ,EAAA,IAAAsJ,EAAA,SAAApD,GAA+DA,EAAAlG,MAI3DwF,KAAAgE,EAAAG,GAC/BF,GAAAF,IAAAO,MAAAV,EAAAC,GAAA,KAAAK,WAGAjK,OAAAC,eAAAb,EAAA,cAA8CmB,OAAA,IAC9C,MAAA2I,EAAiBhK,EAAQ,GAmDzBE,EAAA6J,cAlDA,SAAAqB,EAAAC,EAAAC,GACA,IAAA5I,EACAkB,EACAoD,EACA,wBACApD,EAAAwH,EACApE,EAAAqE,MAEA,yBAMA,UAAAxB,MAAA,mBALAnH,EAAA0I,EACAxH,EAAAyH,EACArE,EAAAsE,EAKAtE,KAAA,GACA,IAAAI,EAAA3C,GAAA8F,EAAAC,UAAA,qBACA,IAAAe,EAAA9G,EAAAC,cACA6G,EAAAC,aAAA,eACA,UACA5H,EAAAa,GACAuC,EAAAnB,OACAmE,EAAAnE,MAAAmB,EAAAnB,OAGA,MAAA4F,GAEA,MADA7I,QAAAgH,MAAA6B,GACAA,EAEA,QACAF,EAAAG,gBAAA,eAGAT,EAAA,SAAAxG,GAGA,GAFAA,EAAAwE,kBACAxE,EAAAkH,cAAA,GACA3E,EAAAE,QAEA,YADAE,EAAA3C,GAGA,IAAAmH,EAAA,iBAAA5E,EAAAE,QACAF,EAAAE,QACAF,EAAAE,UACA8C,EAAA9C,QAAA,CAA0Bb,QAAAuF,EAAA1E,QAAAzC,GAAA2C,EAAA3C,MAI1B,OAFA/B,IACAA,EAAA0B,QAAA6G,GACAA,iCC3DAnK,OAAAC,eAAAb,EAAA,cAA8CmB,OAAA,IAC9C,MAAAe,EAAiBpC,EAAQ,GACzBE,EAAAkK,gBAAA,CAEAyB,iBAAA,IAEA,IAAAC,EAAA5L,EAAAkK,gBACA2B,EAAA,CACAH,KAAA,CAAAI,EAAA5F,IACA,CAAA6F,EAAAC,EAAAC,KAEA,IAAAC,EAAAC,KAAAC,MAAAJ,EAAAF,EAAA/H,OAAA,IAIAmC,EAAAtF,OAAAyL,OAAA,CACAH,WACAI,QALA,aAMAC,UALA,QAMarG,GACb6F,EAAAS,UAAAtG,EAAAoG,QACAP,EAAAU,SAAA,IAAAT,EAAAC,GAEAF,EAAAW,aAA+BxG,EAAAgG,mBAE/BH,EAAAY,UAAA,OAEAZ,EAAAS,UAAAtG,EAAAqG,UACA,IAAAK,EAAAV,EAAAJ,EAAA/H,OACA8I,EAAAV,KAAAC,MAAA,IAAAJ,EAAAY,IACAT,KAAAC,MAAA,IAAAH,EAAA/F,EAAAgG,WAEAH,EAAAe,SAAAhB,EAAAe,EAAAV,KAAAC,MAAA,GAAAH,MAIA,SAAAjC,EAAA+C,EAAA3D,EAAAxD,EAAAM,GACA,IAAA8G,EAAA3K,SAAAgE,cAAA,UACA2G,EAAAD,QACAC,EAAA5D,SACA,IAAA2C,EAAAiB,EAAAC,WAAA,MAGA,OAFA,iBAAArH,EAAAiG,EAAAH,KAAA9F,EAAAM,GAAAN,GACAmG,EAAAgB,EAAA3D,GACA4D,EAAAE,YAEAlN,EAAAgK,sBACA,MAAAmD,EAAA,IACAC,EAAA,IA+DApN,EAAAiK,YAzDA,SAAAzH,EAAA0D,GAEA,GADAA,KAAA,IACA1D,EACA,MAAAN,EAAA2D,OAAAC,aAAA,WACA,IAAAuH,EAAA7K,EAAA8K,KAAA,GACA,GAAyC,GAAzCD,EAAArK,QAAA,0BAAyCR,EAAA,SACzC,OAKA,GAHAA,EAAA8I,aAAA,YAAA+B,GAGAA,IAAAnH,EAAAqH,UAAA,CACA,IAAAC,EAAAH,EAAAG,MAAA,YACA,GAAAA,KAAAzJ,OAAA,GACA,IAAA0J,EAAAD,EAAA,GAAA3K,MAAA,KACA,GAAA4K,EAAA1J,QAAA,GACA,IAAAgJ,EAAA,IAAAW,OAAAD,EAAA,IAAAE,UACAvE,EAAA,IAAAsE,OAAAD,EAAA,IAAAE,UACAzH,EAAAqH,UAAA,CAAqCR,QAAA3D,YAKrClD,EAAAqH,UAAArH,EAAAqH,WAAA,CAA8CR,MAAAI,EAAA/D,OAAAgE,GAE9ClH,EAAA4F,YACA5F,EAAA4F,UAAAtJ,EAAAwD,OAAA,IAGA,IAAA/D,EAAAiE,EAAAqH,UAEA,IAAAK,EAAA5D,EAAA/H,EAAA8K,MAAA9K,EAAAmH,OAAAyC,EAAAH,KAAAxF,EAAA4F,WAAAF,EAAAD,mBAEA,OADAnJ,EAAA8I,aAAA,MAAAsC,GACA,IAAA7I,QAAA,CAAAsC,EAAApC,KACA,GAAAiB,EAAA2H,UACA3H,EAAA2H,YACAlH,KAAAmH,KAAA/I,QAAAsC,QAAAyG,GAAA/I,QAAAE,OAAA,KACA2C,MAAA,KACA,IAAAkG,EAAA9D,EAAA/H,EAAA8K,MAAA9K,EAAAmH,OAAAyC,EAAAH,KAAA,UAA0FQ,SAAA,MAC1F,OAAAnH,QAAAsC,QAAAyG,KAEAnH,KAAAmH,IACAtL,EAAA8K,IAAAQ,EACAtL,EAAA,kBAGA,CACA,IAAAuL,EAAA,IAAAC,MACAD,EAAAE,OAAA,WACAzL,EAAA8K,IAAAhD,KAAAgD,IACA9K,EAAA,YACA6E,EAAA7E,EAAA8K,MAEAS,EAAAT,IAAAD,MAsCArN,EAAAmK,kBAjCA,SAAA+D,EAAAC,GACA,IAAAD,EACA,MAAAhM,EAAA2D,OAAAC,aAAA,aACA,WAAAf,QAAA,CAAAsC,EAAApC,KACA,IAAAmJ,EAAA,IAAAC,WACAD,EAAAE,kBAAAJ,GACAE,EAAAH,OAAA,CAAAM,IACA,IAAAC,EAAA,IAAAC,KAAA,CAAAlK,MAAAkB,OAAA,SACAgD,OAAA,IAAAA,OAAA,KAAAA,OAAA,UACA,IAAAiG,EAAAjG,OAAA,IAAAkG,gBAAAH,GACAT,EAAA,IAAAC,MACAD,EAAAT,IAAAoB,EACAX,EAAAE,OAAA,MACA,IAAAjB,EAAA3K,SAAAgE,cAAA,UAEA,IAAA0G,EAAA,OADAoB,KAAA,IACApB,OAAAoB,EAAApB,MAAAgB,EAAAhB,MAAAoB,EAAApB,MAAAgB,EAAAhB,MACA3D,EAAA,MAAA+E,EAAA/E,QAAA+E,EAAA/E,OAAA2E,EAAA3E,OAAA+E,EAAA/E,OAAA2E,EAAA3E,OACA,MAAA2D,GAAA,MAAA3D,EACAA,EAAA2D,EAAAgB,EAAAhB,MAAAgB,EAAA3E,OAEA,MAAA2D,GAAA,MAAA3D,IACA2D,EAAA3D,EAAA2E,EAAA3E,OAAA2E,EAAAhB,OAEAC,EAAAD,QACAC,EAAA5D,SACA4D,EAAAC,WAAA,MACA2B,UAAAb,EAAA,IAAAhB,EAAA3D,GACA,IAAAyF,EAAA7B,EAAAE,UAAA,iBACA7F,EAAA,CAAyByG,OAAAe,EAAA9B,QAAA3D,kBAkBzBpJ,EAAAoK,aAZA,SAAA0E,GACA,WAAA/J,QAAA,CAAAsC,EAAApC,KACA,IAAAmJ,EAAA,IAAAC,WACAD,EAAAH,OAAA,WACA5G,EAAA+G,EAAArD,OAAAgE,aAEAX,EAAAY,QAAA,WACA/J,EAAAmJ,EAAA1E,QAEA0E,EAAAa,cAAAH","file":"index.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst errors_1 = require(\"./errors\");\r\nfunction dialogContainer() {\r\n    return exports.dialogConfig.dialogContainer || document.body;\r\n}\r\nexports.dialogConfig = {\r\n    dialogContainer: null\r\n};\r\nfunction addClassName(element, className) {\r\n    console.assert(className != null, 'class is null');\r\n    let c1 = (element.className || '').split(/\\s+/);\r\n    let c2 = className.split(/\\s+/);\r\n    var itemsToAdd = c2.filter(o => c1.indexOf(o) < 0);\r\n    c1.push(...itemsToAdd);\r\n    element.className = c1.join(' ');\r\n}\r\nfunction removeClassName(element, className) {\r\n    console.assert(className != null, 'class is null');\r\n    let c1 = (element.className || '').split(/\\s+/);\r\n    let c2 = className.split(/\\s+/);\r\n    var itemsRemain = c1.filter(o => c2.indexOf(o) < 0);\r\n    element.className = itemsRemain.join(' ');\r\n}\r\nlet dialogElements = new Array();\r\nlet dialogCallbacks = new Array();\r\n/** 弹窗\r\n * @param element bootstrap 的 modal 元素\r\n */\r\nfunction showDialog(element, callback) {\r\n    removeClassName(element, 'out');\r\n    element.style.display = 'block';\r\n    setTimeout(() => {\r\n        addClassName(element, 'modal fade in');\r\n    }, 100);\r\n    let dialogIndex = dialogElements.indexOf(element);\r\n    if (dialogIndex < 0) {\r\n        dialogElements.push(element);\r\n        dialogIndex = dialogElements.length - 1;\r\n        let closeButtons = element.querySelectorAll('[data-dismiss=\"modal\"]') || [];\r\n        for (let i = 0; i < closeButtons.length; i++) {\r\n            closeButtons[i].onclick = () => hideDialog(element);\r\n        }\r\n        let allButtons = element.querySelectorAll('button');\r\n        for (let i = 0; i < allButtons.length; i++) {\r\n            allButtons.item(i).addEventListener('click', function (event) {\r\n                let callback = dialogCallbacks[dialogIndex];\r\n                if (callback) {\r\n                    callback(event.currentTarget);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    dialogCallbacks[dialogIndex] = callback;\r\n    element.tabIndex = 1;\r\n    var firstField = element.querySelector('input:not([type]),input:not([readonly])[type=\"text\"],input:not([readonly])[type=\"password\"]');\r\n    if (firstField) {\r\n        firstField.focus();\r\n    }\r\n    else {\r\n        element.focus();\r\n    }\r\n    element.addEventListener('keydown', on_keydown);\r\n}\r\nexports.showDialog = showDialog;\r\nfunction hideDialog(element) {\r\n    removeClassName(element, 'in');\r\n    addClassName(element, 'modal fade out');\r\n    element.removeEventListener('keydown', on_keydown);\r\n    return new Promise((reslove, reject) => {\r\n        setTimeout(() => {\r\n            element.style.removeProperty('display');\r\n            reslove();\r\n        }, 1000);\r\n    });\r\n}\r\nexports.hideDialog = hideDialog;\r\nfunction on_keydown(event) {\r\n    const KEY_CODE_ESC = 27;\r\n    if (event.keyCode == KEY_CODE_ESC) {\r\n        let dialogElement = findDialogElement(event.target);\r\n        console.assert(dialogElement != null);\r\n        if (dialogElement.getAttribute('data-keyboard') == 'false')\r\n            return;\r\n        hideDialog(dialogElement);\r\n    }\r\n}\r\nfunction findDialogElement(e) {\r\n    while (e) {\r\n        let names = e.className.split(' ').filter(o => o);\r\n        if (names.indexOf('modal') >= 0)\r\n            return e;\r\n        e = e.parentElement;\r\n    }\r\n}\r\nfunction alert(args) {\r\n    let element = document.createElement('div');\r\n    dialogContainer().appendChild(element);\r\n    if (typeof args == 'string') {\r\n        args = { title: '&nbsp;', message: args };\r\n    }\r\n    element.innerHTML = `\r\n            <div class=\"modal-dialog\">\r\n                \r\n                <div class=\"modal-content\">\r\n                    <div class=\"modal-header\">\r\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\">\r\n                            <span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span>\r\n                        </button>\r\n                        <h4 class=\"modal-title\">${args.title}</h4>\r\n                    </div>\r\n                    <div class=\"modal-body\">\r\n                        <h5>${args.message}</h5>\r\n                    </div>\r\n                    <div class=\"modal-footer\">\r\n                        <button name=\"ok\" type=\"button\" class=\"btn btn-primary\">\r\n                            确定\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n    // $(element).modal();\r\n    // $(element).on('hidden.bs.modal', () => {\r\n    //     $(element).remove();\r\n    // });\r\n    // var dialog = new Dialog(element);\r\n    // dialog.show();\r\n    showDialog(element);\r\n    let titleElement = element.querySelector('.modal-title');\r\n    let modalFooter = element.querySelector('.modal-footer');\r\n    let cancelButton = modalFooter.querySelector('[name=\"cancel\"]');\r\n    let okButton = modalFooter.querySelector('[name=\"ok\"]');\r\n    okButton.onclick = () => hideDialog(element); //dialog.hide()\r\n}\r\nexports.alert = alert;\r\nfunction confirm(args) {\r\n    let title;\r\n    let message;\r\n    let execute = args.confirm;\r\n    let cancel = args.cancle || (() => Promise.resolve());\r\n    let container = args.container || document.body;\r\n    let confirmText = args.confirmText || '确定';\r\n    let cancelText = args.cancelText || '取消';\r\n    if (typeof args == 'string') {\r\n        message = args;\r\n    }\r\n    else {\r\n        title = args.title;\r\n        message = args.message;\r\n    }\r\n    let confirmDialogElment;\r\n    confirmDialogElment = document.createElement('div');\r\n    confirmDialogElment.className = 'modal fade';\r\n    confirmDialogElment.style.marginTop = '20px';\r\n    console.assert(dialogContainer != null, 'dialog container is null');\r\n    dialogContainer().appendChild(confirmDialogElment);\r\n    confirmDialogElment.innerHTML = `\r\n                    <div class=\"modal-dialog\">\r\n                        <div class=\"modal-content\">\r\n                            <div class=\"modal-header\">\r\n                                <button type=\"button\" class=\"close\" data-dismiss=\"modal\">\r\n                                    <span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span>\r\n                                </button>\r\n                                <h4 class=\"modal-title\">确认</h4>\r\n                            </div>\r\n                            <div class=\"modal-body form-horizontal\">\r\n                               \r\n                            </div>\r\n                            <div class=\"modal-footer\">\r\n                                <button name=\"cancel\" type=\"button\" class=\"btn btn-default\">\r\n                                    ${cancelText}\r\n                                </button>\r\n                                <button name=\"ok\" type=\"button\" class=\"btn btn-primary\">\r\n                                    ${confirmText}\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                `;\r\n    let modalHeader = confirmDialogElment.querySelector('.modal-header');\r\n    let modalBody = confirmDialogElment.querySelector('.modal-body');\r\n    let modalFooter = confirmDialogElment.querySelector('.modal-footer');\r\n    modalBody.innerHTML = `<h5>${message}</h5>`;\r\n    if (title) {\r\n        modalHeader.querySelector('h4').innerHTML = title;\r\n    }\r\n    let cancelButton = modalFooter.querySelector('[name=\"cancel\"]');\r\n    let okButton = modalFooter.querySelector('[name=\"ok\"]');\r\n    let closeButton = modalHeader.querySelector('.close');\r\n    closeButton.onclick = cancelButton.onclick = function () {\r\n        cancel()\r\n            .then(() => hideDialog(confirmDialogElment))\r\n            .then(() => {\r\n            confirmDialogElment.remove();\r\n        });\r\n    };\r\n    okButton.onclick = function (event) {\r\n        execute(event)\r\n            .then(() => hideDialog(confirmDialogElment))\r\n            .then(() => {\r\n            confirmDialogElment.remove();\r\n        })\r\n            .catch(() => hideDialog(confirmDialogElment));\r\n    };\r\n    showDialog(confirmDialogElment);\r\n}\r\nexports.confirm = confirm;\r\nexports.showToastMessage = toast;\r\nfunction toast(obj) {\r\n    if (obj == null)\r\n        throw errors_1.errors.argumentNull('obj');\r\n    let msg;\r\n    let title;\r\n    if (typeof obj == 'object') {\r\n        if (obj.tagName == null) {\r\n            let options = obj;\r\n            msg = options.message;\r\n            title = options.title;\r\n        }\r\n        else {\r\n            msg = obj;\r\n        }\r\n    }\r\n    else {\r\n        msg = obj;\r\n    }\r\n    let dialogContainer = exports.dialogConfig.dialogContainer || document.body;\r\n    let toastDialogElement = document.createElement('div');\r\n    toastDialogElement.className = 'modal fade in';\r\n    toastDialogElement.style.marginTop = '20px';\r\n    console.assert(dialogContainer != null, 'dialog container is null.');\r\n    dialogContainer.appendChild(toastDialogElement);\r\n    let header = title ? `<div class=\"modal-header\">\r\n                                    <h4 class=\"modal-title\">${title}</h4>\r\n                               </div>` : '';\r\n    toastDialogElement.innerHTML = `\r\n                        <div class=\"modal-dialog\">\r\n                            <div class=\"modal-content\">\r\n                                ${header}\r\n                                <div class=\"modal-body form-horizontal\">\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    `;\r\n    let modalBody = toastDialogElement.querySelector('.modal-body');\r\n    console.assert(modalBody != null);\r\n    if (typeof msg == 'string') {\r\n        modalBody.innerHTML = `<h5>${msg}</h5>`;\r\n    }\r\n    else if (typeof msg == 'function') {\r\n        modalBody.innerHTML = `<h5>${msg()}</h5>`;\r\n    }\r\n    else\r\n        modalBody.appendChild(msg);\r\n    // let dialog = new Dialog(toastDialogElement);\r\n    // dialog.show();\r\n    showDialog(toastDialogElement);\r\n    setTimeout(() => {\r\n        hideDialog(toastDialogElement).then(() => {\r\n            toastDialogElement.remove();\r\n        });\r\n    }, 500);\r\n}\r\nexports.toast = toast;\r\nexports.showPanel = (function () {\r\n    let panel = document.createElement('div');\r\n    panel.className = 'mobile-page panel';\r\n    panel.style.display = 'none';\r\n    document.body.appendChild(panel);\r\n    panel.innerHTML = `\r\n            <div class=\"modal\">\r\n                <div class=\"modal-dialog\">\r\n                    <div class=\"modal-content\">\r\n                        <div class=\"modal-header\">\r\n    \r\n                        </div>\r\n                        <div class=\"modal-body\">\r\n    \r\n                        </div>\r\n                        <div class=\"modal-footer\">\r\n    \r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"modal-backdrop in\">\r\n            </div>\r\n        `;\r\n    let modal = panel.querySelector('.modal');\r\n    let backdrop = panel.querySelector('.modal-backdrop');\r\n    let header = panel.querySelector('.modal-header');\r\n    let footer = panel.querySelector('.modal-footer');\r\n    let body = panel.querySelector(\".modal-body\");\r\n    let modalDialog = panel.querySelector(\".modal-dialog\");\r\n    let isIOS = navigator.userAgent.indexOf('iPhone') > 0 || navigator.userAgent.indexOf('iPad') > 0;\r\n    //=====================================================================\r\n    // 点击非窗口区域，关窗口。并禁用上级元素的 touch 操作。\r\n    // let panel = this.panel; //this.refs['panel'] as HTMLElement;\r\n    // let modalDialog = this.modalDialog; //this.refs['modalDialog'] as HTMLElement;\r\n    panel.addEventListener('touchstart', (event) => {\r\n        let dialogRect = modalDialog.getBoundingClientRect();\r\n        for (let i = 0; i < event.touches.length; i++) {\r\n            let { clientX } = event.touches[i];\r\n            if (clientX < dialogRect.left) {\r\n                hide();\r\n                return;\r\n            }\r\n        }\r\n    });\r\n    if (isIOS) {\r\n        panel.addEventListener('touchstart', (event) => {\r\n            let tagName = event.target.tagName;\r\n            if (tagName == 'BUTTON' || tagName == 'INPUT' || tagName == 'A') {\r\n                return;\r\n            }\r\n            event.stopPropagation();\r\n            event.preventDefault();\r\n        });\r\n    }\r\n    function hide() {\r\n        modal.style.removeProperty('transform');\r\n        backdrop.style.opacity = '0';\r\n        window.setTimeout(() => {\r\n            panel.style.display = 'none';\r\n        }, 500);\r\n    }\r\n    return function showPanel(args) {\r\n        args = args || {};\r\n        panel.style.display = 'block';\r\n        modal.style.display = 'block';\r\n        setTimeout(() => {\r\n            modal.style.transform = 'translateX(0)';\r\n            backdrop.style.opacity = '0.5';\r\n        }, 50);\r\n        let setBodyHeight = () => {\r\n            let headerHeight = header.getBoundingClientRect().height;\r\n            let footerHeight = footer.getBoundingClientRect().height;\r\n            let bodyHeight = window.innerHeight - headerHeight - footerHeight;\r\n            body.style.height = `${bodyHeight}px`;\r\n        };\r\n        window.addEventListener('resize', () => setBodyHeight());\r\n        setBodyHeight();\r\n        if (args.header)\r\n            args.header(header);\r\n        if (args.body)\r\n            args.body(body);\r\n        if (args.footer)\r\n            args.footer(footer);\r\n        return {\r\n            hide: () => hide()\r\n        };\r\n    };\r\n})();\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.errors = {\r\n    argumentNull(paramName) {\r\n        let msg = `Argumnet ${paramName} can not be null or empty.`;\r\n        let error = new Error();\r\n        error.message = msg;\r\n        return error;\r\n    }\r\n};\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar buttonOnClick_1 = require(\"./buttonOnClick\");\r\nexports.buttonOnClick = buttonOnClick_1.buttonOnClick;\r\nvar dialog_1 = require(\"./dialog\");\r\nexports.showDialog = dialog_1.showDialog;\r\nexports.hideDialog = dialog_1.hideDialog;\r\nexports.toast = dialog_1.toast;\r\nexports.alert = dialog_1.alert;\r\nexports.confirm = dialog_1.confirm;\r\nexports.dialogConfig = dialog_1.dialogConfig;\r\nvar image_1 = require(\"./image\");\r\nexports.generateImageBase64 = image_1.generateImageBase64;\r\nexports.renderImage = image_1.renderImage;\r\nexports.loadImageConfig = image_1.loadImageConfig;\r\nexports.imageFileToBase64 = image_1.imageFileToBase64;\r\nexports.fileToBase64 = image_1.fileToBase64;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst dialog_1 = require(\"./dialog\");\r\nfunction buttonOnClick(arg1, arg2, arg3) {\r\n    let element;\r\n    let callback;\r\n    let args;\r\n    if (typeof (arg1) == 'function') {\r\n        callback = arg1;\r\n        args = arg2;\r\n    }\r\n    else if (typeof (arg2) == 'function') {\r\n        element = arg1;\r\n        callback = arg2;\r\n        args = arg3;\r\n    }\r\n    else {\r\n        throw new Error(\"Arguments error\");\r\n    }\r\n    args = args || {};\r\n    let execute = (event) => __awaiter(this, void 0, void 0, function* () {\r\n        let button = event.currentTarget;\r\n        button.setAttribute('disabled', '');\r\n        try {\r\n            yield callback(event);\r\n            if (args.toast) {\r\n                dialog_1.toast(args.toast);\r\n            }\r\n        }\r\n        catch (exc) {\r\n            console.error(exc);\r\n            throw exc;\r\n        }\r\n        finally {\r\n            button.removeAttribute('disabled');\r\n        }\r\n    });\r\n    let result = function (event) {\r\n        event.stopPropagation();\r\n        event.cancelBubble = true;\r\n        if (!args.confirm) {\r\n            execute(event);\r\n            return;\r\n        }\r\n        let text = typeof args.confirm == 'string' ?\r\n            args.confirm :\r\n            args.confirm();\r\n        dialog_1.confirm({ message: text, confirm: (event) => execute(event) });\r\n    };\r\n    if (element)\r\n        element.onclick = result;\r\n    return result;\r\n}\r\nexports.buttonOnClick = buttonOnClick;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst errors_1 = require(\"./errors\");\r\nexports.loadImageConfig = {\r\n    /** 图片显示的文字 */\r\n    imageDisaplyText: '',\r\n};\r\nlet config = exports.loadImageConfig;\r\nlet draws = {\r\n    text: (imageText, options) => {\r\n        return (ctx, canvasWidth, canvasHeight) => {\r\n            // let fontSize1 = Math.floor(canvasHeight / 3 * 0.8);\r\n            let fontSize = Math.floor((canvasWidth / imageText.length) * 0.6);\r\n            let bgColor = 'whitesmoke';\r\n            let textColor = '#999';\r\n            // let fontSize = Math.min(fontSize1, fontSize2);\r\n            options = Object.assign({\r\n                fontSize,\r\n                bgColor,\r\n                textColor\r\n            }, options);\r\n            ctx.fillStyle = options.bgColor; //'whitesmoke';\r\n            ctx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n            // 设置字体\r\n            ctx.font = `Bold ${options.fontSize}px Arial`;\r\n            // 设置对齐方式\r\n            ctx.textAlign = \"left\";\r\n            // 设置填充颜色\r\n            ctx.fillStyle = options.textColor; //\"#999\";\r\n            let textWidth = fontSize * imageText.length;\r\n            let startX = Math.floor((canvasWidth - textWidth) * 0.5);\r\n            let startY = Math.floor((canvasHeight - options.fontSize) * 0.3);\r\n            // 设置字体内容，以及在画布上的位置\r\n            ctx.fillText(imageText, startX, Math.floor(canvasHeight * 0.6));\r\n        };\r\n    }\r\n};\r\nfunction generateImageBase64(width, height, obj, options) {\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = width; //img_width;\r\n    canvas.height = height; //img_height;\r\n    var ctx = canvas.getContext('2d');\r\n    let draw = typeof obj == 'string' ? draws.text(obj, options) : obj;\r\n    draw(ctx, width, height);\r\n    return canvas.toDataURL();\r\n}\r\nexports.generateImageBase64 = generateImageBase64;\r\nconst PREVIEW_IMAGE_DEFAULT_WIDTH = 200;\r\nconst PREVIEW_IMAGE_DEFAULT_HEIGHT = 200;\r\n/**\r\n * 在 IMG 元素上渲染图片\r\n * @param element 要渲染的 IMG 元素\r\n * @param options 渲染选项，默认将 IMG 元素的 SRC 属性渲染出来\r\n */\r\nfunction renderImage(element, options) {\r\n    options = options || {};\r\n    if (!element)\r\n        throw errors_1.errors.argumentNull('element');\r\n    let imageUrl = element.src || '';\r\n    if (imageUrl.indexOf('data:image/png;base64') == 0 || element['rendered']) {\r\n        return;\r\n    }\r\n    element.setAttribute(\"image-url\", imageUrl);\r\n    //====================================================\r\n    // 通过 URL 设置图片大小\r\n    if (imageUrl && !options.imageSize) {\r\n        var match = imageUrl.match(/_\\d+_\\d+/);\r\n        if (match && match.length > 0) {\r\n            var arr = match[0].split('_');\r\n            if (arr.length >= 2) {\r\n                var width = new Number(arr[1]).valueOf();\r\n                var height = new Number(arr[2]).valueOf();\r\n                options.imageSize = { width, height };\r\n            }\r\n        }\r\n    }\r\n    //====================================================\r\n    options.imageSize = options.imageSize || { width: PREVIEW_IMAGE_DEFAULT_WIDTH, height: PREVIEW_IMAGE_DEFAULT_HEIGHT };\r\n    //====================================================\r\n    if (!options.imageText) {\r\n        options.imageText = element.title || '';\r\n        ;\r\n    }\r\n    let s = options.imageSize;\r\n    //设置默认的图片\r\n    var src_replace = generateImageBase64(s.width, s.height, draws.text(options.imageText || config.imageDisaplyText)); //getPreviewImage(imageText || config.imageDisaplyText, img_width, img_height);\r\n    element.setAttribute('src', src_replace);\r\n    return new Promise((resolve, reject) => {\r\n        if (options.loadImage) {\r\n            options.loadImage()\r\n                .then(base64 => base64 ? Promise.resolve(base64) : Promise.reject({}))\r\n                .catch(() => {\r\n                let base64 = generateImageBase64(s.width, s.height, draws.text('加载图片失败', { fontSize: 24 }));\r\n                return Promise.resolve(base64);\r\n            })\r\n                .then((base64) => {\r\n                element.src = base64;\r\n                element['rendered'] = true;\r\n            });\r\n        }\r\n        else {\r\n            var image = new Image();\r\n            image.onload = function () {\r\n                element.src = this.src;\r\n                element['rendered'] = true;\r\n                resolve(element.src);\r\n            };\r\n            image.src = imageUrl;\r\n        }\r\n    });\r\n}\r\nexports.renderImage = renderImage;\r\nfunction imageFileToBase64(imageFile, size) {\r\n    if (!imageFile)\r\n        throw errors_1.errors.argumentNull('imageFile');\r\n    return new Promise((resolve, reject) => {\r\n        var reader = new FileReader();\r\n        reader.readAsArrayBuffer(imageFile);\r\n        reader.onload = (ev) => {\r\n            var blob = new Blob([event.target['result']]);\r\n            window['URL'] = window['URL'] || window['webkitURL'];\r\n            var blobURL = window['URL'].createObjectURL(blob);\r\n            var image = new Image();\r\n            image.src = blobURL;\r\n            image.onload = () => {\r\n                var canvas = document.createElement('canvas');\r\n                size = size || {};\r\n                let width = size.width != null && size.width < image.width ? size.width : image.width;\r\n                let height = size.height != null && size.height < image.height ? size.height : image.height;\r\n                if (width != null && height == null) {\r\n                    height = width / image.width * image.height;\r\n                }\r\n                else if (width == null && height != null) {\r\n                    width = height / image.height * image.width;\r\n                }\r\n                canvas.width = width;\r\n                canvas.height = height;\r\n                var ctx = canvas.getContext(\"2d\");\r\n                ctx.drawImage(image, 0, 0, width, height);\r\n                let data = canvas.toDataURL(\"image/jpeg\", 0.5);\r\n                resolve({ base64: data, width, height });\r\n            };\r\n        };\r\n    });\r\n}\r\nexports.imageFileToBase64 = imageFileToBase64;\r\nfunction fileToBase64(file) {\r\n    return new Promise((resolve, reject) => {\r\n        let reader = new FileReader();\r\n        reader.onload = function () {\r\n            resolve(reader.result.toString());\r\n        };\r\n        reader.onerror = function () {\r\n            reject(reader.error);\r\n        };\r\n        reader.readAsDataURL(file);\r\n    });\r\n}\r\nexports.fileToBase64 = fileToBase64;\r\n"],"sourceRoot":""}